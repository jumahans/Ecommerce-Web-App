{% extends 'layout.html' %}
{% load static %}

{% block content %}
<div class="card fade-in" style="width: 90%; max-width: 1200px; margin: 2rem auto;">
    <h2 style="color: var(--text-dark); font-size: 2rem; margin-bottom: 1.5rem; padding-bottom: 0.75rem; border-bottom: 2px solid #f1f3f5;">Your Shopping Cart</h2>
    {% if cart_items %}
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 2rem;">
        <tr style="background: #f1f3f5; color: #333; font-weight: 600;">
            <th style="padding: 1rem; text-align: left;">Product</th>
            <th style="padding: 1rem; text-align: left;">Image</th>
            <th style="padding: 1rem; text-align: left;">Price</th>
            <th style="padding: 1rem; text-align: left;">Quantity</th>
            <th style="padding: 1rem; text-align: left;">Total</th>
            <th style="padding: 1rem; text-align: left;">Actions</th>
        </tr>
        {% for item in cart_items %}
        <tr style="border-bottom: 1px solid #f1f3f5;">
            <td style="padding: 1rem;">{{ item.product.name }}</td>
            <td style="padding: 1rem;"><img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" style="width: 80px; height: 80px; object-fit: contain; border-radius: var(--border-radius); background: #f1f3f5;"></td>
            <td style="padding: 1rem;">sh {{ item.price }}</td>
            <td style="padding: 1rem;">{{ item.quantity }}</td>
            <td style="padding: 1rem;">sh {{ item.price|floatformat:2 }}</td>
            <td style="padding: 1rem;">
                <form action="{% url 'remove_from_cart' item.id %}" method="POST" style="display: inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-secondary pop" style="padding: 0.4rem 1rem; font-size: 0.9rem;">Remove</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
    <h3 style="font-size: 1.3rem; color: var(--text-dark); text-align: right; margin: 1.5rem 0; font-weight: 600;">Total Price: sh {{ total_price }}</h3>
    <form method="POST" action="{% url 'checkout' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary pop" style="float: right;">Proceed to Checkout</button>
    </form>
    {% else %}
    <p class="alert alert-info fade-in" style="text-align: center;">Your cart is empty.</p>
    {% endif %}
</div>
{% endblock %}
